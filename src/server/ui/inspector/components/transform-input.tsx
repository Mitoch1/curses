import { FC }                          from "react";
import { useGetState, useUpdateState } from "@/client";
import { InputBaseText, InputDoubleContainer }                           from "./input";
import {TransformRect}                 from "@/client/elements/schema";
import { useSnapshot } from "valtio";

const TransformInput: FC<{id: string}> = ({id}) => {
  const {activeScene} = useSnapshot(window.ApiClient.scenes.state);
  const rect = useGetState(state => state.elements[id].scenes[activeScene]?.rect);
  const update = useUpdateState();

  const handleUpdate = (key: keyof TransformRect, value: string) => update(state => {
    state.elements[id].scenes[activeScene].rect[key] = parseFloat(value);
  });

  return <>
    <InputDoubleContainer label="common.field_position">
        <InputBaseText value={rect?.x} onChange={e => handleUpdate("x", e.target.value)} type="number"/>
        <InputBaseText value={rect?.y} onChange={e => handleUpdate("y", e.target.value)} type="number"/>
    </InputDoubleContainer>
    <InputDoubleContainer label="common.field_size">
        <InputBaseText value={rect?.w} onChange={e => handleUpdate("w", e.target.value)} type="number"/>
        <InputBaseText value={rect?.h} onChange={e => handleUpdate("h", e.target.value)} type="number"/>
    </InputDoubleContainer>
  </>
}

export default TransformInput
